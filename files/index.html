<!DOCTYPE html>
<html>
<head>
    <title>YouTube Player</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
		a {
			color:#121212;
            text-shadow: none;
		}
        body {
		    background-image: url('{{ url_for('static', filename='wallpaper.png') }}');
            background-repeat: repeat;
            background-size: auto;
            background-color: #E82D76;
            text-shadow: 
                -2px -2px 0 #121212,  
                 2px -2px 0 #121212,
                -2px  2px 0 #121212,
                 2px  2px 0 #121212;
            color: #FF5799;
			font-weight: bold;
        }
        button {
			font-weight: bold;
            background-color: #121212;
            color: #FF5799;
            cursor: pointer;
        }
        button:hover {
			background-color: #FF5799;
            color: #121212;
        }
        form {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        input {
            margin-bottom: 3px;
			width: 60vw;
			min-width: 200px;
        }
		input[type="text"],
		button {
			color: #121212;
			background-color: #FF5799;
		}
        label {
            margin-bottom: 5px;
        }
        ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        .centered {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
		.divider {
			border-bottom: 2px solid #121212;
			margin: 5px;
		}
		.queueListBorder {
			border: 5px solid #121212;
			padding: 10px;
			margin: 0px;
		}
		#controlButtons {
			display: flex;
			justify-content: center;
			margin-top: 0px;
		}
		#controlButtons form {
			margin: 0px;
		}
		#queueList {
			background-color: #B92F6BDD;
			scrollbar-width: thin;
			scrollbar-color: #121212 #E82D76;
			flex: 1;
			overflow-y: auto;
			max-height: 50vh;
			width: calc(60vw - 20px); /* Subtract total padding and border width */
			min-width: 200px;
		}
		#searchResultsContainer {
            background-color: #B92F6BDD;
			scrollbar-width: thin;
			scrollbar-color: #121212 #E82D76;
			flex: 1;
			overflow-y: auto;
			max-height: 50vh;
			border: 5px solid #121212;
			width: 60vw;
			min-width: 200px;
		}
		#searchResultsContainer::-webkit-scrollbar {
			display: none;
		}
		#searchResultsContainer::-webkit-scrollbar-thumb {
			background-color: #121212;
			border-radius: 5px;
		}
		#searchResultsContainer::-webkit-scrollbar-track {
			background-color: #E82D76;
			border-radius: 5px;
		}
    </style>
</head>
<body>
    <div class="centered">
        <form action="/close" method="post">
            <button type="submit">Close Player</button>
        </form>
        <h1>YouTube Player</h1>
        <form action="/" method="post">
            <label for="search_term">Search:</label>
            <input type="text" id="search_term" name="search_term" value="{{ search_term }}">
            <button type="submit">Search</button>
        </form>
        {% if message %}
            <p>{{ message }}</p>
        {% endif %}
        <form action="{{ url_for('add_to_queue') }}" method="post">
            <label for="video_url">URL:</label>
            <input type="text" id="video_url" name="video_url" required>
            <button type="submit">Add to Queue</button>
        </form>
		<div id="controlButtons">
			{% if app.config['VIDEO_QUEUE'] %}
				<form action="/play" method="post">
                    <input type="hidden" name="search_term" value="{{ search_term }}">
					<button type="submit">Play</button>
				</form>
				<form action="/shuffle_queue" method="post">
                    <input type="hidden" name="search_term" value="{{ search_term }}">
					<button type="submit">Shuffle</button>
				</form>
				<form action="/clear" method="post">
                    <input type="hidden" name="search_term" value="{{ search_term }}">
					<button type="submit">Clear</button>
				</form>
			{% endif %}
		</div>
		<br>
		<div id="controlButtons">
			<form action="/skip" method="post">
                <input type="hidden" name="search_term" value="{{ search_term }}">
				<button type="submit">Skip</button>
			</form>
			<form action="/seekbackward" method="post">
                <input type="hidden" name="search_term" value="{{ search_term }}">
				<button type="submit">Seek Backward</button>
			</form>
			<form action="/seekforward" method="post">
                <input type="hidden" name="search_term" value="{{ search_term }}">
				<button type="submit">Seek Forward</button>
			</form>
		</div>
		{% if results %}
			<h2>Search Results</h2>
			<div id="searchResultsContainer">
				<ul id="searchResults">
				{% for result in results %}
				<li style="display: flex;">
                    <form action="/queue" method="post">
                        <input type="hidden" name="video_url" value="{{ result.video_url }}">
                        <input type="hidden" name="search_term" value="{{ search_term }}">
                        <button type="submit">Queue</button>
                    </form>
					<a href="https://www.youtube.com/watch?v={{ result.video_url }}" target="_blank">{{ result.title }}</a>
				</li>
				<div class="divider"></div>
				{% endfor %}
				</ul>
			</div>
		{% endif %}
		<ul id="queueList" class="{% if app.config['VIDEO_QUEUE'] %}queueListBorder{% endif %}">
		</ul>
		<a href=https://github.com/NeonLightning/ style="margin-top: 50px; background-color: #E82D76DD;">NeonLightning's github</a>
    </div>
    <script>
		function updateQueue() {
			fetch('/get_queue')
				.then(response => response.json())
				.then(data => {
					const queueList = document.getElementById('queueList');
					queueList.innerHTML = '';
					data.forEach((videoInfo, index) => {
						const li = document.createElement('li');
					    const toTopForm = document.createElement('form');
						toTopForm.setAttribute('action', '/move_to_top');
						toTopForm.setAttribute('method', 'post');
						toTopForm.setAttribute('style', 'display:inline-block;');
						const toTopInput = document.createElement('input');
						toTopInput.setAttribute('type', 'hidden');
						toTopInput.setAttribute('name', 'index');
						toTopInput.setAttribute('value', index);
						const toTopButton = document.createElement('button');
						toTopButton.setAttribute('type', 'submit');
						toTopButton.textContent = '⇑';
						toTopForm.appendChild(toTopInput);
						toTopForm.appendChild(toTopButton);
						li.appendChild(toTopForm);
						const upForm = document.createElement('form');
						upForm.setAttribute('action', '/move_up');
						upForm.setAttribute('method', 'post');
						upForm.setAttribute('style', 'display:inline-block;');
						const upInput = document.createElement('input');
						upInput.setAttribute('type', 'hidden');
						upInput.setAttribute('name', 'index');
						upInput.setAttribute('value', index);
						const upButton = document.createElement('button');
						upButton.setAttribute('type', 'submit');
						upButton.textContent = '▲';
						upForm.appendChild(upInput);
						upForm.appendChild(upButton);
						li.appendChild(upForm);
						const downForm = document.createElement('form');
						downForm.setAttribute('action', '/move_down');
						downForm.setAttribute('method', 'post');
						downForm.setAttribute('style', 'display:inline-block;');
						const downInput = document.createElement('input');
						downInput.setAttribute('type', 'hidden');
						downInput.setAttribute('name', 'index');
						downInput.setAttribute('value', index);
						const downButton = document.createElement('button');
						downButton.setAttribute('type', 'submit');
						downButton.textContent = '▼';
						downForm.appendChild(downInput);
						downForm.appendChild(downButton);
						li.appendChild(downForm);
						const toBottomForm = document.createElement('form');
						toBottomForm.setAttribute('action', '/move_to_bottom');
						toBottomForm.setAttribute('method', 'post');
						toBottomForm.setAttribute('style', 'display:inline-block;');
						const toBottomInput = document.createElement('input');
						toBottomInput.setAttribute('type', 'hidden');
						toBottomInput.setAttribute('name', 'index');
						toBottomInput.setAttribute('value', index);
						const toBottomButton = document.createElement('button');
						toBottomButton.setAttribute('type', 'submit');
						toBottomButton.textContent = '⇓';
						toBottomForm.appendChild(toBottomInput);
						toBottomForm.appendChild(toBottomButton);
						li.appendChild(toBottomForm);
						const removeForm = document.createElement('form');
						removeForm.setAttribute('action', '/remove');
						removeForm.setAttribute('method', 'post');
						removeForm.setAttribute('style', 'display:inline;');
						const removeInput = document.createElement('input');
						removeInput.setAttribute('type', 'hidden');
						removeInput.setAttribute('name', 'index');
						removeInput.setAttribute('value', index);
						const removeButton = document.createElement('button');
						removeButton.setAttribute('type', 'submit');
						removeButton.textContent = 'Remove';
						removeForm.appendChild(removeInput);
						removeForm.appendChild(removeButton);
						li.appendChild(removeForm);
						const link = document.createElement('a');
						link.setAttribute('href', `https://www.youtube.com/watch?v=${videoInfo.video_id}`);
						link.setAttribute('target', '_blank');
						link.textContent = videoInfo.title;
						li.appendChild(link);
						queueList.appendChild(li);
					});
				});
		}
		setInterval(updateQueue, 1000);
		updateQueue();
    </script>
</body>
</html>